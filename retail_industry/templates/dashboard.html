<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>零售信贷分析 - 智能工作台</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* === 全局风格 === */
        body {
            background-color: #F3F0FF;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            color: #444;
        }

        /* === 顶部导航栏美化 === */
        .navbar {
            background: linear-gradient(135deg, #663399 0%, #9370DB 100%);
            box-shadow: 0 2px 10px rgba(75, 0, 130, 0.2);
            padding-top: 0.8rem;
            padding-bottom: 0.8rem;
        }
        .navbar-brand {
            color: white !important;
            font-weight: bold;
            font-size: 1.3rem;
        }

        /* 导航菜单链接样式 */
        .nav-link {
            color: rgba(255, 255, 255, 0.7) !important;
            font-size: 1rem;
            margin-right: 15px;
            transition: all 0.3s;
        }
        .nav-link:hover {
            color: white !important;
        }
        /* 当前激活页面的样式 */
        .nav-link.active {
            color: white !important;
            font-weight: bold;
            border-bottom: 2px solid white; /* 底部加个白线 */
        }

        .user-profile {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: white;
        }

        /* === 主容器 === */
        .main-card {
            background: white;
            border-radius: 12px;
            border: none;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin-top: 30px;
            margin-bottom: 30px;
            padding: 25px;
        }

        /* === 表格 === */
        .table-custom thead {
            background-color: #f8f9fa;
            color: #666;
            font-weight: 600;
            border-bottom: 2px solid #e9ecef;
        }
        .table-custom th { border: none; padding: 15px 10px; white-space: nowrap; }
        .table-custom td { vertical-align: middle; padding: 12px 10px; border-bottom: 1px solid #f0f0f0; font-size: 14px; }
        .table-hover tbody tr:hover { background-color: #F8F0FF; }

        /* 状态徽章 */
        .badge-status { padding: 5px 10px; border-radius: 4px; font-size: 12px; font-weight: normal; }
        .bg-pass { background-color: #e6f9ed; color: #28a745; border: 1px solid #bcebd1; }
        .bg-reject { background-color: #ffe6e6; color: #dc3545; border: 1px solid #fadbd8; }
        .bg-review { background-color: #fff8e1; color: #ffc107; border: 1px solid #ffecb5; }

        /* === 卡片 === */
        .stat-card {
            border: none; border-radius: 8px; color: white; height: 120px;
            position: relative; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .stat-card:hover { transform: translateY(-3px); }
        .card-body-custom { padding: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; z-index: 2; position: relative; }
        .card-label { font-size: 0.9rem; opacity: 0.9; margin-bottom: 5px; }
        .card-value { font-size: 2.2rem; font-weight: bold; font-family: 'Arial', sans-serif; }
        .card-icon-bg { position: absolute; right: -10px; bottom: -15px; font-size: 5rem; opacity: 0.15; z-index: 1; transform: rotate(-15deg); }
        .card-blue { background: #4169E1; }
        .card-gray { background: #6c757d; }
        .card-green { background: #28a745; }
        .card-red { background: #dc3545; }
        .card-yellow { background: #ffc107; color: #333 !important; }

        /* === 批量操作工具栏样式 === */
        #batchToolbar {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 1px solid #90caf9;
            border-radius: 8px;
            padding: 12px 20px;
            margin-bottom: 15px;
        }
        #batchToolbar .btn {
            font-size: 0.875rem;
            padding: 6px 12px;
        }
        #batchToolbar strong {
            color: #1976d2;
            font-size: 1.1rem;
        }

        /* === 表格排序样式 === */
        .sortable-header {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 20px !important;
            transition: background-color 0.2s;
        }
        .sortable-header:hover {
            background-color: #e9ecef;
        }
        .sort-icon {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.75rem;
            color: #663399;
        }
        .sort-icon.active {
            color: #663399;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2"></i><span class="d-none d-sm-inline">零售信贷分析系统</span><span class="d-inline d-sm-none">信贷系统</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" style="border: 1px solid rgba(255,255,255,0.3);">
                <span class="navbar-toggler-icon" style="filter: invert(1);"></span>
            </button>

            <div class="collapse navbar-collapse ms-4" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="/dashboard"><i class="fas fa-list me-1"></i> 数据列表</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/analysis"><i class="fas fa-chart-pie me-1"></i> 可视化分析</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/prediction"><i class="fas fa-brain me-1"></i> AI 预测</a>
                    </li>
                    {% if role == 'admin' %}
                        <li class="nav-item ms-2">
                            <a class="nav-link text-warning fw-bold" href="/logs">
                                <i class="fas fa-shield-alt"></i> 审计日志
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>

            <div class="d-flex align-items-center ms-auto">
                <a href="/profile" class="btn btn-outline-light btn-sm rounded-pill px-2 px-md-3 me-2" title="进入个人中心">
                    <i class="fas fa-user-circle me-1"></i> <span class="d-none d-md-inline">{{ user_name }} <small>({{ role }})</small></span><span class="d-inline d-md-none">{{ user_name }}</span>
                </a>

                <a href="/" class="btn btn-light btn-sm fw-bold text-primary">退出</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="main-card">

            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-bold text-secondary mb-0">
                    <i class="fas fa-history me-2"></i>贷款申请记录
                </h5>

                <div class="d-flex gap-2">
                    <form action="/dashboard" method="get" class="d-flex">
                        <div class="input-group">
                            <input type="text" name="q" class="form-control"
                                   placeholder="搜商户/ID..."
                                   value="{{ search_query or '' }}"
                                   style="width: 200px;"> <button class="btn btn-primary" type="submit" style="background-color: #663399; border-color: #663399;">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>

                    <a href="/dashboard" class="btn btn-outline-secondary" title="重置/刷新">
                        <i class="fas fa-sync-alt"></i>
                    </a>

                    <a href="/export?q={{ search_query or '' }}" class="btn btn-success text-white" title="下载 Excel报表">
                        <i class="fas fa-file-excel me-1"></i> 导出报表
                    </a>
                    <button class="btn btn-primary ms-2" data-bs-toggle="modal" data-bs-target="#addModal">
                        <i class="fas fa-plus"></i> 新增
                    </button>
                </div>
            </div>

            <!-- 快捷筛选按钮 -->
            <div class="mb-3">
                <div class="d-flex flex-wrap gap-2 align-items-center">
                    <div class="btn-group flex-wrap" role="group" style="flex: 1 1 auto;">
                        <a href="/dashboard?status=" class="btn btn-sm {% if not status_filter %}btn-primary{% else %}btn-outline-primary{% endif %}" title="显示全部">
                            <i class="fas fa-list me-1"></i> <span class="d-none d-sm-inline">全部</span>
                        </a>
                        <a href="/dashboard?status=待审核" class="btn btn-sm {% if status_filter == '待审核' %}btn-warning{% else %}btn-outline-warning{% endif %}" title="待审核记录">
                            <i class="fas fa-clock me-1"></i> <span class="d-none d-md-inline">待审核</span>
                        </a>
                        <a href="/dashboard?status=通过" class="btn btn-sm {% if status_filter == '通过' %}btn-success{% else %}btn-outline-success{% endif %}" title="已通过记录">
                            <i class="fas fa-check-circle me-1"></i> <span class="d-none d-md-inline">已通过</span>
                        </a>
                        <a href="/dashboard?status=拒绝" class="btn btn-sm {% if status_filter == '拒绝' %}btn-danger{% else %}btn-outline-danger{% endif %}" title="已拒绝记录">
                            <i class="fas fa-times-circle me-1"></i> <span class="d-none d-md-inline">已拒绝</span>
                        </a>
                        <a href="/dashboard?score_max=600" class="btn btn-sm {% if score_max == '600' %}btn-danger{% else %}btn-outline-danger{% endif %}" title="高风险记录（信用分≤600）">
                            <i class="fas fa-exclamation-triangle me-1"></i> <span class="d-none d-lg-inline">高风险</span>
                        </a>
                    </div>
                    <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#advancedFilter" aria-expanded="false" aria-controls="advancedFilter">
                        <i class="fas fa-filter me-1"></i> <span class="d-none d-sm-inline">高级筛选</span>
                    </button>
                </div>
            </div>

            <!-- 高级筛选器 -->
            <div class="collapse mb-3" id="advancedFilter">
                <div class="card card-body bg-light">
                    <form action="/dashboard" method="get" id="filterForm">
                        <!-- 隐藏字段：保持搜索和排序 -->
                        <input type="hidden" name="q" value="{{ search_query or '' }}">
                        <input type="hidden" name="sort" value="{{ sort_column }}">
                        <input type="hidden" name="order" value="{{ sort_order }}">
                        
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">状态</label>
                                <select name="status" class="form-select form-select-sm">
                                    <option value="">全部状态</option>
                                    {% for status in status_options %}
                                    <option value="{{ status }}" {% if status_filter == status %}selected{% endif %}>{{ status }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">行业类型</label>
                                <select name="type" class="form-select form-select-sm">
                                    <option value="">全部行业</option>
                                    {% for type in type_options %}
                                    <option value="{{ type }}" {% if type_filter == type %}selected{% endif %}>{{ type }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">城市</label>
                                <select name="city" class="form-select form-select-sm">
                                    <option value="">全部城市</option>
                                    {% for city in city_options %}
                                    <option value="{{ city }}" {% if city_filter == city %}selected{% endif %}>{{ city }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">信用分范围</label>
                                <div class="input-group input-group-sm">
                                    <input type="number" name="score_min" class="form-control" placeholder="最小值" value="{{ score_min or '' }}" min="0" max="1000">
                                    <span class="input-group-text">-</span>
                                    <input type="number" name="score_max" class="form-control" placeholder="最大值" value="{{ score_max or '' }}" min="0" max="1000">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">金额范围（万元）</label>
                                <div class="input-group input-group-sm">
                                    <input type="number" name="amount_min" class="form-control" placeholder="最小金额" value="{{ amount_min or '' }}" step="0.01" min="0">
                                    <span class="input-group-text">-</span>
                                    <input type="number" name="amount_max" class="form-control" placeholder="最大金额" value="{{ amount_max or '' }}" step="0.01" min="0">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label small fw-bold">申请日期范围</label>
                                <div class="input-group input-group-sm">
                                    <input type="date" name="date_from" class="form-control" value="{{ date_from or '' }}">
                                    <span class="input-group-text">至</span>
                                    <input type="date" name="date_to" class="form-control" value="{{ date_to or '' }}">
                                </div>
                            </div>
                            <div class="col-md-3 d-flex align-items-end">
                                <button type="submit" class="btn btn-primary btn-sm me-2">
                                    <i class="fas fa-search me-1"></i> 应用筛选
                                </button>
                                <a href="/dashboard" class="btn btn-outline-secondary btn-sm">
                                    <i class="fas fa-redo me-1"></i> 清除
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- 批量操作工具栏 -->
            {% if role == 'admin' %}
            <div id="batchToolbar" class="alert alert-info d-none align-items-center mb-3" role="alert">
                <div class="d-flex align-items-center flex-grow-1">
                    <i class="fas fa-check-square me-2"></i>
                    <span class="me-3">已选择 <strong id="selectedCount">0</strong> 项</span>
                    <button type="button" class="btn btn-sm btn-success me-2" id="btnBatchApprove" onclick="batchApprove()">
                        <i class="fas fa-check-double me-1"></i> 批量审批
                    </button>
                    <button type="button" class="btn btn-sm btn-primary me-2" id="btnBatchExport" onclick="batchExport()">
                        <i class="fas fa-file-excel me-1"></i> 批量导出
                    </button>
                    <button type="button" class="btn btn-sm btn-danger me-2" id="btnBatchDelete" onclick="batchDelete()">
                        <i class="fas fa-trash-alt me-1"></i> 批量删除
                    </button>
                    <button type="button" class="btn btn-sm btn-secondary" onclick="clearSelection()">
                        <i class="fas fa-times me-1"></i> 取消选择
                    </button>
                </div>
            </div>
            {% endif %}

            <div class="table-responsive">
                <table class="table table-custom table-hover">
                    <thead>
                        <tr>
                            {% if role == 'admin' %}
                            <th style="width: 50px;">
                                <input type="checkbox" id="selectAll" onchange="toggleSelectAll(this)" title="全选/取消全选">
                            </th>
                            {% endif %}
                            <th class="sortable-header" onclick="sortTable('id')">
                                #ID
                                <span class="sort-icon">
                                    {% if sort_column == 'id' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th class="sortable-header" onclick="sortTable('name')">
                                品类/商户
                                <span class="sort-icon">
                                    {% if sort_column == 'name' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th class="sortable-header" onclick="sortTable('type')">
                                行业类型
                                <span class="sort-icon">
                                    {% if sort_column == 'type' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th class="sortable-header" onclick="sortTable('amount')">
                                注册金额
                                <span class="sort-icon">
                                    {% if sort_column == 'amount' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th class="sortable-header" onclick="sortTable('score')">
                                信用评分
                                <span class="sort-icon">
                                    {% if sort_column == 'score' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th class="sortable-header" onclick="sortTable('monthly_flow')">
                                月均营收
                                <span class="sort-icon">
                                    {% if sort_column == 'monthly_flow' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th class="sortable-header" onclick="sortTable('date')">
                                申请时间
                                <span class="sort-icon">
                                    {% if sort_column == 'date' %}
                                        {% if sort_order == 'ASC' %}
                                            <i class="fas fa-sort-up active"></i>
                                        {% else %}
                                            <i class="fas fa-sort-down active"></i>
                                        {% endif %}
                                    {% else %}
                                        <i class="fas fa-sort"></i>
                                    {% endif %}
                                </span>
                            </th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in rows %}
                        <tr>
                            {% if role == 'admin' %}
                            <td>
                                <input type="checkbox" class="row-checkbox" value="{{ row.id }}" onchange="updateBatchToolbar()">
                            </td>
                            {% endif %}
                            <td>{{ row.id }}</td>
                            <td class="fw-bold">{{ row.name }}</td>
                            <td>{{ row.type }}</td>
                            <td>¥ {{ row.amount }} 万</td>
                            <td>
                                {% if row.score >= 700 %}
                                    <span class="text-success fw-bold">{{ row.score }}</span>
                                {% elif row.score >= 600 %}
                                    <span class="text-warning fw-bold">{{ row.score }}</span>
                                {% else %}
                                    <span class="text-danger fw-bold">{{ row.score }}</span>
                                {% endif %}
                            </td>
                            <td>{{ row.monthly_flow }}</td>
                            <td>{{ row.date }}</td>
                            <td>
                                {% if '通过' in row.status %}
                                    <span class="badge-status bg-pass">{{ row.status }}</span>
                                {% elif '复核' in row.status %}
                                    <span class="badge-status bg-review">{{ row.status }}</span>
                                {% else %}
                                    <span class="badge-status bg-reject">{{ row.status }}</span>
                                {% endif %}
                            </td>
                            <td>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-light text-primary" onclick="showDetail(this)"
                                        data-bs-toggle="modal"
                                        data-bs-target="#detailModal"
                                        title="查看详情"
                                        data-id="{{ row.id }}"
                                        data-name="{{ row.name }}"
                                        data-type="{{ row.type }}"
                                        data-city="{{ row.city }}"
                                        data-city_level="{{ row.city_level }}"
                                        data-years="{{ row.years }}"
                                        data-employees="{{ row.employees }}"
                                        data-area="{{ row.area }}"
                                        data-traffic="{{ row.traffic }}"
                                        data-monthly_flow="{{ row.monthly_flow }}"
                                        data-cost="{{ row.cost }}"
                                        data-amount="{{ row.amount }}"
                                        data-score="{{ row.score }}">
                                    <i class="fas fa-eye"></i>
                                </button>

                                {% if session.get('user_name') == 'admin' %}
                                    {% if '通过' not in row.status %}
                                        <a href="/approve/{{ row.id }}"
                                            class="btn btn-sm btn-success mx-1"
                                            title="一键通过"
                                            onclick="return confirm('确定要批准【{{ row.name }}】的申请吗？');">
                                            <i class="fas fa-check"></i>
                                        </a>
                                    {% endif %}
                                {% endif %}

                                {% if role == 'admin' %}

                                    <button class="btn btn-sm btn-light text-warning" onclick="openEditModal(this)"
                                            title="编辑修改"
                                            data-id="{{ row.id }}"
                                            data-name="{{ row.name }}"
                                            data-amount="{{ row.amount }}"
                                            data-score="{{ row.score }}"
                                            data-type="{{ row.type }}"
                                            data-monthly_flow="{{ row.monthly_flow }}"
                                            data-cost="{{ row.cost }}"
                                            data-traffic="{{ row.traffic }}"
                                            data-city="{{ row.city }}">
                                        <i class="fas fa-edit"></i>
                                    </button>

                                    <form action="/delete/{{ row.id }}" method="post" style="margin:0;" onsubmit="return confirm('⚠️ 确定要删除这条数据吗？');">
                                        <button type="submit" class="btn btn-sm btn-light text-danger" title="删除数据">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>

                                {% endif %}
                                </div>
                        </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <nav aria-label="Page navigation" class="d-flex justify-content-center mt-4">
                <ul class="pagination">
                    <li class="page-item {% if current_page == 1 %}disabled{% endif %}">
                        <a class="page-link" href="{{ url_for('dashboard', page=current_page-1, q=search_query, sort=sort_column, order=sort_order, status=status_filter, type=type_filter, score_min=score_min, score_max=score_max, amount_min=amount_min, amount_max=amount_max, date_from=date_from, date_to=date_to, city=city_filter) }}">上一页</a>
                    </li>

                    <li class="page-item disabled">
                        <span class="page-link" style="background-color: #f3f0ff; color: #663399; font-weight: bold;">
                            第 {{ current_page }} 页 / 共 {{ total_pages }} 页
                        </span>
                    </li>

                    <li class="page-item {% if current_page == total_pages %}disabled{% endif %}">
                        <a class="page-link" href="{{ url_for('dashboard', page=current_page+1, q=search_query, sort=sort_column, order=sort_order, status=status_filter, type=type_filter, score_min=score_min, score_max=score_max, amount_min=amount_min, amount_max=amount_max, date_from=date_from, date_to=date_to, city=city_filter) }}">下一页</a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="row g-4 mb-4" id="kpi-widget-container">

    <style>
        .kpi-card-new {
            border: none; border-radius: 12px;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            position: relative; overflow: hidden;
        }
        .kpi-card-new:hover { transform: translateY(-5px); }
        .kpi-icon-bg {
            position: absolute; right: -10px; bottom: -10px;
            font-size: 5rem; opacity: 0.1; transform: rotate(-15deg);
        }
        .trend-badge {
            font-size: 0.75rem; padding: 2px 8px; border-radius: 10px;
            display: inline-flex; align-items: center;
        }
        .trend-up { background-color: #d1fae5; color: #065f46; } /* 绿色涨 */
        .trend-down { background-color: #fee2e2; color: #991b1b; } /* 红色跌 */
        .trend-flat { background-color: #f3f4f6; color: #4b5563; } /* 灰色平 */
        
        /* 统计卡片点击效果 */
        .kpi-card-clickable {
            cursor: pointer;
            transition: all 0.2s;
        }
        .kpi-card-clickable:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1) !important;
        }
        .sparkline-container {
            width: 100%;
            opacity: 0.7;
        }

        /* === 响应式优化 === */
        @media (max-width: 768px) {
            /* 移动端导航栏优化 */
            .navbar-brand {
                font-size: 1.1rem;
            }
            .nav-link {
                font-size: 0.9rem;
                margin-right: 0;
                padding: 0.5rem 1rem;
            }
            
            /* 主容器移动端优化 */
            .main-card {
                margin-top: 15px;
                margin-bottom: 15px;
                padding: 15px;
                border-radius: 8px;
            }
            
            /* 表格移动端优化 */
            .table-responsive {
                font-size: 0.85rem;
            }
            .table-custom th,
            .table-custom td {
                padding: 8px 5px;
                font-size: 0.8rem;
            }
            .table-custom th {
                font-size: 0.75rem;
            }
            
            /* 按钮组移动端优化 */
            .btn-group {
                display: flex;
                flex-wrap: wrap;
                gap: 5px;
            }
            .btn-group .btn {
                flex: 1;
                min-width: 80px;
                font-size: 0.75rem;
                padding: 5px 8px;
            }
            
            /* 顶部操作栏移动端优化 */
            .d-flex.gap-2 {
                flex-wrap: wrap;
                gap: 5px !important;
            }
            .input-group {
                width: 100% !important;
                margin-bottom: 5px;
            }
            .input-group input {
                font-size: 0.9rem;
            }
            
            /* 统计卡片移动端优化 */
            .kpi-card-new {
                margin-bottom: 15px;
            }
            .kpi-card-new h2 {
                font-size: 1.5rem;
            }
            .kpi-icon-bg {
                font-size: 3.5rem;
            }
            
            /* 批量操作工具栏移动端优化 */
            #batchToolbar {
                padding: 10px;
            }
            #batchToolbar .d-flex {
                flex-wrap: wrap;
                gap: 5px;
            }
            #batchToolbar .btn {
                font-size: 0.75rem;
                padding: 5px 8px;
                flex: 1;
                min-width: 70px;
            }
            
            /* 高级筛选器移动端优化 */
            .collapse .card-body {
                padding: 15px;
            }
            .collapse .row.g-3 > div {
                margin-bottom: 10px;
            }
            
            /* 分页移动端优化 */
            .pagination {
                flex-wrap: wrap;
                justify-content: center;
            }
            .page-link {
                font-size: 0.85rem;
                padding: 0.375rem 0.5rem;
            }
            
            /* 操作按钮移动端优化 */
            .d-flex.gap-2 .btn-sm {
                padding: 4px 6px;
                font-size: 0.75rem;
            }
            
            /* 标题移动端优化 */
            h5.fw-bold {
                font-size: 1rem;
            }
        }

        @media (max-width: 576px) {
            /* 超小屏幕优化 */
            .container {
                padding-left: 10px;
                padding-right: 10px;
            }
            
            .navbar-brand {
                font-size: 1rem;
            }
            
            .main-card {
                padding: 10px;
            }
            
            .table-custom th,
            .table-custom td {
                padding: 6px 3px;
                font-size: 0.75rem;
            }
            
            .kpi-card-new h2 {
                font-size: 1.3rem;
            }
            
            .btn-sm {
                font-size: 0.7rem;
                padding: 3px 5px;
            }
            
            /* 表格横向滚动提示 */
            .table-responsive::after {
                content: "← 左右滑动查看更多 →";
                display: block;
                text-align: center;
                padding: 5px;
                font-size: 0.7rem;
                color: #999;
                background-color: #f8f9fa;
                border-top: 1px solid #e9ecef;
            }
        }

        /* 触摸设备优化 */
        @media (hover: none) and (pointer: coarse) {
            .btn, .nav-link, .kpi-card-clickable {
                -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
            }
            
            .table-hover tbody tr:active {
                background-color: #F8F0FF;
            }
        }
    </style>

    <div class="col-md-3">
        <a href="/dashboard" class="text-decoration-none" style="color: inherit;">
            <div class="card kpi-card-new p-3 h-100 border-start border-4 border-primary kpi-card-clickable">
                <div class="text-muted small fw-bold text-uppercase">总申请单数</div>
                <h2 class="fw-bold mt-2 mb-2" id="val_total">...</h2>
                <div id="trend_total">
                    <span class="spinner-border spinner-border-sm text-secondary"></span>
                </div>
                <div id="sparkline_total" class="sparkline-container" style="height: 30px; margin-top: 8px;"></div>
                <i class="fas fa-file-invoice kpi-icon-bg text-primary"></i>
            </div>
        </a>
    </div>

    <div class="col-md-3">
        <a href="/dashboard?status=待审核" class="text-decoration-none" style="color: inherit;">
            <div class="card kpi-card-new p-3 h-100 border-start border-4 border-warning kpi-card-clickable">
                <div class="text-muted small fw-bold text-uppercase">待人工复核</div>
                <h2 class="fw-bold mt-2 mb-2" id="val_review">...</h2>
                <div id="trend_review">...</div>
                <i class="fas fa-user-clock kpi-icon-bg text-warning"></i>
            </div>
        </a>
    </div>

    <div class="col-md-3">
        <a href="/dashboard?status=通过" class="text-decoration-none" style="color: inherit;">
            <div class="card kpi-card-new p-3 h-100 border-start border-4 border-success kpi-card-clickable">
                <div class="text-muted small fw-bold text-uppercase">放款总金额 (万)</div>
                <h2 class="fw-bold mt-2 mb-2 text-success" id="val_amount">...</h2>
                <div id="trend_amount">...</div>
                <div id="sparkline_amount" class="sparkline-container" style="height: 30px; margin-top: 8px;"></div>
                <i class="fas fa-coins kpi-icon-bg text-success"></i>
            </div>
        </a>
    </div>

    <div class="col-md-3">
        <div class="card kpi-card-new p-3 h-100 border-start border-4 border-info">
            <div class="text-muted small fw-bold text-uppercase">平均信用分</div>
            <h2 class="fw-bold mt-2 mb-2 text-info" id="val_score">...</h2>
            <div id="trend_score">...</div>
            <i class="fas fa-tachometer-alt kpi-icon-bg text-info"></i>
        </div>
    </div>

</div>

<script>
    // 绘制简单的Sparkline图表（使用Canvas）
    function drawSparkline(canvasId, data, color) {
        const canvas = document.getElementById(canvasId);
        if (!canvas || !data || data.length === 0) return;
        
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        
        // 清除画布
        ctx.clearRect(0, 0, width, height);
        
        // 计算数据范围
        const max = Math.max(...data, 1);
        const min = Math.min(...data, 0);
        const range = max - min || 1;
        
        // 绘制线条
        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        ctx.beginPath();
        
        data.forEach((value, index) => {
            const x = data.length > 1 ? (index / (data.length - 1)) * width : width / 2;
            const y = height - ((value - min) / range) * height;
            
            if (index === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });
        
        ctx.stroke();
        
        // 绘制填充区域
        ctx.fillStyle = color + '20';
        ctx.lineTo(width, height);
        ctx.lineTo(0, height);
        ctx.closePath();
        ctx.fill();
    }

    document.addEventListener("DOMContentLoaded", function() {
        // 调用我们刚才写的独立 API
        fetch('/api/kpi_trends')
            .then(response => response.json())
            .then(data => {
                // 辅助函数：渲染趋势箭头
                const renderTrend = (trendObj) => {
                    let icon = trendObj.dir === 'up' ? '<i class="fas fa-arrow-up me-1"></i>' :
                              (trendObj.dir === 'down' ? '<i class="fas fa-arrow-down me-1"></i>' : '<i class="fas fa-minus me-1"></i>');
                    let cls = trendObj.dir === 'up' ? 'trend-up' : (trendObj.dir === 'down' ? 'trend-down' : 'trend-flat');
                    let text = trendObj.dir === 'up' ? '较上周' : (trendObj.dir === 'down' ? '较上周' : '较上周');
                    return `<span class="trend-badge ${cls}">${icon} ${trendObj.val}</span> <span class="text-muted small ms-1">${text}</span>`;
                };

                // 更新界面
                document.getElementById('val_total').innerText = data.total_count;
                document.getElementById('trend_total').innerHTML = renderTrend(data.count_trend);
                
                // 绘制总申请单数趋势图
                if (data.count_sparkline && data.count_sparkline.length > 0) {
                    const sparklineDiv = document.getElementById('sparkline_total');
                    if (sparklineDiv) {
                        // 使用setTimeout确保DOM已渲染，可以获取正确的宽度
                        setTimeout(() => {
                            const canvas = document.createElement('canvas');
                            canvas.width = sparklineDiv.offsetWidth || 100;
                            canvas.height = 30;
                            canvas.id = 'canvas_total';
                            sparklineDiv.innerHTML = '';
                            sparklineDiv.appendChild(canvas);
                            drawSparkline('canvas_total', data.count_sparkline, '#4169E1');
                        }, 100);
                    }
                }

                document.getElementById('val_review').innerText = data.wait_review;
                document.getElementById('trend_review').innerHTML = renderTrend(data.review_trend);

                document.getElementById('val_amount').innerText = "¥ " + data.total_amount.toLocaleString();
                document.getElementById('trend_amount').innerHTML = renderTrend(data.amount_trend);
                
                // 绘制放款金额趋势图
                if (data.amount_sparkline && data.amount_sparkline.length > 0) {
                    const sparklineDiv = document.getElementById('sparkline_amount');
                    if (sparklineDiv) {
                        // 使用setTimeout确保DOM已渲染，可以获取正确的宽度
                        setTimeout(() => {
                            const canvas = document.createElement('canvas');
                            canvas.width = sparklineDiv.offsetWidth || 100;
                            canvas.height = 30;
                            canvas.id = 'canvas_amount';
                            sparklineDiv.innerHTML = '';
                            sparklineDiv.appendChild(canvas);
                            drawSparkline('canvas_amount', data.amount_sparkline, '#28a745');
                        }, 100);
                    }
                }

                document.getElementById('val_score').innerText = data.avg_score;
                document.getElementById('trend_score').innerHTML = renderTrend(data.score_trend);
            })
            .catch(err => console.error("KPI 加载失败:", err));
    });
</script>
    </div>

    <div class="modal fade" id="detailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header text-white" style="background: linear-gradient(135deg, #663399, #9370DB);">
                    <h5 class="modal-title"><i class="fas fa-store me-2"></i>商户详细档案</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="row g-3">
                        <div class="col-md-6"><label class="text-secondary small">企业ID</label><div class="fw-bold fs-5" id="m_id">--</div></div>
                        <div class="col-md-6"><label class="text-secondary small">商户名称</label><div class="fw-bold fs-5" id="m_name">--</div></div>
                        <div class="col-12"><hr class="my-2"></div>
                        <div class="col-md-4"><label class="text-secondary small">所在城市</label><div class="fw-bold" id="m_city">--</div></div>
                        <div class="col-md-4"><label class="text-secondary small">城市等级</label><div class="fw-bold" id="m_city_level">--</div></div>
                        <div class="col-md-4"><label class="text-secondary small">经营年份</label><div class="fw-bold"><span id="m_years">--</span> 年</div></div>
                        <div class="col-md-4"><label class="text-secondary small">员工人数</label><div class="fw-bold"><span id="m_employees">--</span> 人</div></div>
                        <div class="col-md-4"><label class="text-secondary small">门店面积</label><div class="fw-bold"><span id="m_area">--</span> ㎡</div></div>
                        <div class="col-md-4"><label class="text-secondary small">月均客流量</label><div class="fw-bold"><span id="m_traffic">--</span> 人次</div></div>
                        <div class="col-12"><hr class="my-2"></div>
                        <div class="col-md-4"><div class="p-2 border rounded bg-light"><label class="text-secondary small">月均营收</label><div class="text-success fw-bold">¥ <span id="m_monthly_flow">--</span> 万</div></div></div>
                        <div class="col-md-4"><div class="p-2 border rounded bg-light"><label class="text-secondary small">月均成本</label><div class="text-danger fw-bold">¥ <span id="m_cost">--</span> 万</div></div></div>
                        <div class="col-md-4"><div class="p-2 border rounded bg-light"><label class="text-secondary small">注册金额</label><div class="text-primary fw-bold">¥ <span id="m_amount">--</span> 万</div></div></div>
                    </div>
                </div>
                <div class="modal-footer bg-light"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ========== 表格排序功能 ==========
        function sortTable(column) {
            const currentSort = '{{ sort_column }}';
            const currentOrder = '{{ sort_order }}';
            
            // 如果点击的是当前排序列，切换排序方向；否则使用新列，默认降序
            let newOrder = 'DESC';
            if (currentSort === column) {
                newOrder = currentOrder === 'DESC' ? 'ASC' : 'DESC';
            }
            
            // 构建URL参数
            const params = new URLSearchParams(window.location.search);
            params.set('sort', column);
            params.set('order', newOrder);
            params.set('page', '1'); // 排序后重置到第一页
            
            // 跳转到新URL
            window.location.href = '/dashboard?' + params.toString();
        }

        // ========== 批量操作功能 ==========
        // 全选/取消全选
        function toggleSelectAll(checkbox) {
            const rowCheckboxes = document.querySelectorAll('.row-checkbox');
            rowCheckboxes.forEach(cb => {
                cb.checked = checkbox.checked;
            });
            updateBatchToolbar();
        }

        // 更新批量操作工具栏显示
        function updateBatchToolbar() {
            const selectedCheckboxes = document.querySelectorAll('.row-checkbox:checked');
            const count = selectedCheckboxes.length;
            const toolbar = document.getElementById('batchToolbar');
            const selectedCount = document.getElementById('selectedCount');
            const selectAllCheckbox = document.getElementById('selectAll');

            if (count > 0) {
                toolbar.classList.remove('d-none');
                selectedCount.textContent = count;

                // 更新全选checkbox状态
                const allCheckboxes = document.querySelectorAll('.row-checkbox');
                selectAllCheckbox.checked = (count === allCheckboxes.length);
            } else {
                toolbar.classList.add('d-none');
                if (selectAllCheckbox) selectAllCheckbox.checked = false;
            }
        }

        // 清除所有选择
        function clearSelection() {
            document.querySelectorAll('.row-checkbox').forEach(cb => cb.checked = false);
            const selectAllCheckbox = document.getElementById('selectAll');
            if (selectAllCheckbox) selectAllCheckbox.checked = false;
            updateBatchToolbar();
        }

        // 获取选中的ID列表
        function getSelectedIds() {
            const checkboxes = document.querySelectorAll('.row-checkbox:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        // 批量审批
        function batchApprove() {
            const ids = getSelectedIds();
            if (ids.length === 0) {
                alert('请先选择要审批的记录！');
                return;
            }

            if (!confirm(`确定要批量审批 ${ids.length} 条记录吗？`)) {
                return;
            }

            fetch('/api/batch-approve', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ ids: ids })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(`✅ 成功审批 ${data.approved_count} 条记录！`);
                    clearSelection();
                    location.reload();
                } else {
                    alert('❌ 审批失败：' + (data.error || '未知错误'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('❌ 操作失败，请重试');
            });
        }

        // 批量删除
        function batchDelete() {
            const ids = getSelectedIds();
            if (ids.length === 0) {
                alert('请先选择要删除的记录！');
                return;
            }

            if (!confirm(`⚠️ 确定要批量删除 ${ids.length} 条记录吗？此操作不可恢复！`)) {
                return;
            }

            fetch('/api/batch-delete', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ ids: ids })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(`✅ 成功删除 ${data.deleted_count} 条记录！`);
                    clearSelection();
                    location.reload();
                } else {
                    alert('❌ 删除失败：' + (data.error || '未知错误'));
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('❌ 操作失败，请重试');
            });
        }

        // 批量导出
        function batchExport() {
            const ids = getSelectedIds();
            if (ids.length === 0) {
                alert('请先选择要导出的记录！');
                return;
            }

            // 将选中的ID作为查询参数传递给导出接口
            const idsParam = ids.join(',');
            window.location.href = `/export?ids=${idsParam}`;
        }

        var detailModal = document.getElementById('detailModal')
        detailModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget
            var id = button.getAttribute('data-id')
            var name = button.getAttribute('data-name')
            var city = button.getAttribute('data-city')
            var city_level = button.getAttribute('data-city_level')
            var years = button.getAttribute('data-years')
            var employees = button.getAttribute('data-employees')
            var area = button.getAttribute('data-area')
            var traffic = button.getAttribute('data-traffic')
            var monthly_flow = button.getAttribute('data-monthly_flow')
            var cost = button.getAttribute('data-cost')
            var amount = button.getAttribute('data-amount')

            detailModal.querySelector('#m_id').textContent = id
            detailModal.querySelector('#m_name').textContent = name
            detailModal.querySelector('#m_city').textContent = city || '未知'
            detailModal.querySelector('#m_city_level').textContent = city_level || '未知'
            detailModal.querySelector('#m_years').textContent = years || '0'
            detailModal.querySelector('#m_employees').textContent = employees || '0'
            detailModal.querySelector('#m_area').textContent = area || '0'
            detailModal.querySelector('#m_traffic').textContent = traffic || '0'
            detailModal.querySelector('#m_monthly_flow').textContent = monthly_flow || '0'
            detailModal.querySelector('#m_cost').textContent = cost || '0'
            detailModal.querySelector('#m_amount').textContent = amount
        })

        function openEditModal(button) {
        // 1. 从按钮的 data- 属性里拿数据
        var id = button.getAttribute('data-id');
        var name = button.getAttribute('data-name');
        var amount = button.getAttribute('data-amount');
        var score = button.getAttribute('data-score');
        var type = button.getAttribute('data-type');
        var flow = button.getAttribute('data-monthly_flow');
        var cost = button.getAttribute('data-cost');
        var traffic = button.getAttribute('data-traffic');
        var city = button.getAttribute('data-city');

        // 2. 把数据填到弹窗的 input 里
        document.getElementById('edit_id').value = id; // 填入隐藏的ID
        document.getElementById('edit_name').value = name;
        document.getElementById('edit_amount').value = amount;
        document.getElementById('edit_score').value = score;
        document.getElementById('edit_type').value = type;
        document.getElementById('edit_flow').value = flow;
        document.getElementById('edit_cost').value = cost;
        document.getElementById('edit_traffic').value = traffic;
        document.getElementById('edit_city').value = city;

        // 3. 显示弹窗
        var myModal = new bootstrap.Modal(document.getElementById('editModal'));
        myModal.show();
    }
    </script>

<div class="modal fade" id="addModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">📝 录入新申请</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form action="/add" method="post">
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">商户名称</label>
                        <input type="text" name="name" class="form-control" required placeholder="例如：7-11便利店">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">申请金额 (万元)</label>
                        <input type="number" name="amount" class="form-control" required placeholder="50">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">信用评分</label>
                        <input type="number" name="score" class="form-control" required placeholder="650">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">月均营收 (万元)</label>
                        <input type="number" step="0.1" name="monthly_flow" class="form-control" placeholder="例如：15.5">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">月均客流量 (人次)</label>
                        <input type="number" name="traffic" class="form-control" placeholder="例如：3000">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">月均成本 (万元)</label>
                        <input type="number" step="0.1" name="cost" class="form-control" placeholder="例如：10.5">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">所在城市</label>
                        <select name="city" class="form-select">
                            <option value="北京">北京</option>
                            <option value="上海">上海</option>
                            <option value="广州">广州</option>
                            <option value="深圳">深圳</option>
                            <option value="杭州">杭州</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">品类/商户</label>
                        <select name="type" class="form-select">
                            <option value="家电零售">家电零售</option>
                            <option value="服饰零售">服饰零售</option>
                            <option value="便利店">便利店</option>
                            <option value="生鲜零售">生鲜零售</option>
                            <option value="美妆零售">美妆零售</option>
                            <option value="文具零售">文具零售</option>
                            <option value="综合商超">综合商超</option>
                        </select>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-primary">保存提交</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="editModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark"> <h5 class="modal-title"><i class="fas fa-edit"></i> 修改商户信息</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form action="/update" method="post">
                <div class="modal-body">
                    <input type="hidden" name="id" id="edit_id">

                    <div class="mb-3">
                        <label>商户名称</label>
                        <input type="text" name="name" id="edit_name" class="form-control" required>
                    </div>
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label>注册金额 (万)</label>
                            <input type="number" step="0.01" name="amount" id="edit_amount" class="form-control">
                        </div>
                        <div class="col-6 mb-3">
                            <label>信用评分</label>
                            <input type="number" step="0.1" name="score" id="edit_score" class="form-control">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label>月均营收</label>
                            <input type="number" step="0.01" name="monthly_flow" id="edit_flow" class="form-control">
                        </div>
                        <div class="col-6 mb-3">
                            <label>月均成本</label>
                            <input type="number" step="0.01" name="cost" id="edit_cost" class="form-control">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label>月均客流</label>
                        <input type="number" name="traffic" id="edit_traffic" class="form-control">
                    </div>
                    <div class="mb-3">
                        <label>行业类型</label>
                        <select name="type" id="edit_type" class="form-select">
                            <option value="家电零售">家电零售</option>
                            <option value="服饰零售">服饰零售</option>
                            <option value="便利店">便利店</option>
                            <option value="生鲜零售">生鲜零售</option>
                            <option value="美妆零售">美妆零售</option>
                            <option value="文具零售">文具零售</option>
                            <option value="综合商超">综合商超</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label>所在城市</label>
                        <input type="text" name="city" id="edit_city" class="form-control">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="submit" class="btn btn-warning">保存修改</button>
                </div>
            </form>
        </div>
    </div>
</div>

</body>
</html>